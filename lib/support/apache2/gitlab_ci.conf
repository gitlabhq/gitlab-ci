<VirtualHost *:80>
	# example host name
	ServerName ci.gitlab.org
	ServerAdmin webmaster@ci.gitlab.org

	DocumentRoot /home/gitlab_ci/gitlab-ci/public

	ProxyPreserveHost On
	<Location />
		Order deny,allow
		Allow from all

		ProxyPassReverse http://127.0.0.1:9292
		
		# Your hostname again:
		ProxyPassReverse http://ci.gitlab.org/
	</Location>

	RewriteEngine on
	RewriteCond %{DOCUMENT_ROOT}/%{REQUEST_FILENAME} !-f
	RewriteRule .* http://127.0.0.1:9292%{REQUEST_URI} [P,QSA]

	## if you're using SSL please run `a2enmod headers` and uncomment the following line:
	# RequestHeader set X_FORWARDED_PROTO 'https'

	ErrorLog "/var/log/apache2/gitlab-ci-error.log"
	CustomLog "/var/log/apache2/gitlab-ci-access.log" combined

	ErrorDocument 404 /404.html
	ErrorDocument 422 /422.html
	ErrorDocument 500 /500.html
	ErrorDocument 503 /deploy.html
</VirtualHost>

