= form_for @project do |f|
  - if @project.errors.any?
    #error_explanation
      %p.lead= "#{pluralize(@project.errors.count, "error")} prohibited this project from being saved:"
      .alert.alert-error
        %ul
          - @project.errors.full_messages.each do |msg|
            %li= msg

  .row-fluid
    .span6
      %fieldset
        %legend Project
        .field
          = f.label :name
          = f.text_field :name, class: 'input-xlarge', placeholder: 'my-project', readonly: @project.github?
        .field
          = f.label :token, "Token (Leave empty to generate random token)"
          = f.text_field :token, class: 'input-xlarge', placeholder: 'xEeFCaDAB89', readonly: @project.github?
        .field
          = f.label :public do
            = f.check_box :public, class: 'input-xlarge'
            %span Public (Anyone can see project and builds list)

      %fieldset
        %legend Git
        .field
          = f.label :path
          = f.text_field :path, class: 'input-xlarge', placeholder: '/home/gitlab_ci/projectname', readonly: @project.github?
        .field
          = f.label :default_ref, "Follow branches"
          = f.text_field :default_ref, class: 'input-xlarge', placeholder: 'master, stable'
          %small You will be able to filter builds by following branches

      - unless @project.github?
        %fieldset
          %legend GitLab
          .field
            = f.label :gitlab_url, "GitLab url to project"
            = f.text_field :gitlab_url, class: 'input-xlarge', placeholder: 'http://gitlab.domain.com/project-slug'

    .span6

      %fieldset
        %legend Build
        .field
          = f.label :timeout, 'Timeout (in seconds) per command'
          = f.number_field :timeout, class: 'input-xlarge'
        .field
          = f.label :scripts
          = f.text_area :scripts, class: 'input-xxlarge', rows: 11, placeholder: "bundle exec rake spec", readonly: @project.github?


      %fieldset
        %legend Build Schedule
        .field
          = f.label :always_build do
            = f.check_box :always_build
            %span Enable automatic build on schedule
        %br
        .field
          = f.label :polling_interval, "Build interval"
          = f.number_field :polling_interval, placeholder: '5'
          %span Hours
  .form-actions
    = f.submit 'Save', class: 'btn btn-primary'
    = link_to 'Cancel', projects_path, class: 'btn'
    - unless @project.new_record?
      - if @project.github?
        = link_to 'Regenerate keys', regenerate_github_project_path(@project), method: :post, class: "btn regenerate-keys-btn", remote: true, confirm: "Are you sure?"
      - unless @project.github?
        = link_to 'Remove Project', project_path(@project), method: :delete, confirm: 'Project will be removed. Are you sure?', class: 'btn btn-danger right'
